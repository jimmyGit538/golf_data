config {
    type: "table",
    schema: "golf_warehouse",
    bigquery: {
        clusterBy: ["practice_date"]
    }
}


SELECT
  practice_date,
  (SUM(tenshotstddev_carry_yds) - SUM(carry_yds_target_deviation))/count(*) AS carry_yds_variance,
FROM
  ${ref("shot_moving_stddev")}
GROUP BY
  practice_date
